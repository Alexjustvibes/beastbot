parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"z1yr":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),e=exports.Context||(exports.Context={});
},{}],"uCOr":[function(require,module,exports) {
"use strict";function t(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function e(t,e,r=1){let n=0;for(;null!==t.exec(e);)if(++n===r)return e.slice(t.lastIndex);return""}function r(t,e){return((e||"").match(t)||[]).length}function n(t,e){let r=e.toLowerCase();r.startsWith("@")&&(r=r.substring(1));const n=[];for(const s of t.members.array()){if(e==`${s.user.username}#${s.user.discriminator}`)return[s];if(null!=s.nickname){const t=s.nickname.toLowerCase();if(r===t){n.push(s);continue}if(t.startsWith(r)){n.push(s);continue}if(t.includes(r)){n.push(s);continue}}const t=s.user.username.toLowerCase();if(t.startsWith(r)){if(r===t){n.push(s);continue}if(t.startsWith(r)){n.push(s);continue}if(t.includes(r)){n.push(s);continue}}}return n}async function s(t,e){let r=[];for(let n of t)r.push(e.call(n,n));await Promise.all(r)}function i(t,e){for(const r of t)if(e.startsWith(r))return!0;return!1}function o(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function u(t,e){for(var r=[],n=0,s=t.length;n<s;)r.push(t.slice(n,n+=e));return r}function c(t){return t.hasPermission("BAN_MEMBERS")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.escapeRegExp=t,exports.getEverythingAfterMatch=e,exports.regexCount=r,exports.findMemberByUsername=n,exports.asyncForEach=s,exports.includeStartsWith=i,exports.arrayEqual=o,exports.chunkArray=u,exports.isAdministrator=c;
},{}],"UL96":[function(require,module,exports) {
"use strict";var e;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e.Beastars="20523",e.BeastComplex="22194"}(e=exports.Manga||(exports.Manga={}));class s{constructor(e){this.message=e}}exports.CommandError=s;
},{}],"E3oo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("./helpers"),s=require("./types"),t=require("./Context");class r{constructor(s,t){this.defaultPrefix=e.escapeRegExp(s),this.commands=t,this.customPrefixes=[];for(const r of t)r.useDefaultPrefix||this.customPrefixes.push({prefix:e.escapeRegExp(r.name),command:r})}parseCommand(r){const o=(r=r.trim()).split(/\s+/),n=o[0].toLowerCase();if(n==this.defaultPrefix){if(1===o.length)throw new s.CommandError(`Missing command, to see the list of commands use \`${t.Context.prefix} help\``);const n=(s,t)=>{const n=t.split(/\s+/g),c=n.length-1,i=o.slice(1,2+c).map(e=>e.toLowerCase());return e.arrayEqual(n,i)?{success:!0,command:s,args:o.splice(2+c),fullArgs:e.getEverythingAfterMatch(/\s+/g,r,2+c)}:{success:!1}};for(const e of this.commands){if(e.useDefaultPrefix){const s=n(e,e.name);if(s.success)return s}for(const s of e.aliases||[]){const t=n(e,s);if(t.success)return t}}throw new s.CommandError(`Invalid command, to see the list of commands use \`${t.Context.prefix} help\`\nIf you want to use the image feature don't forget the command name \`${t.Context.prefix} i [name]\``)}for(const s of this.customPrefixes)if(n===s.prefix)return{success:!0,command:s.command,args:o.slice(1),fullArgs:e.getEverythingAfterMatch(/\s+/g,r,1)};return{success:!1}}}exports.default=r;
},{"./helpers":"uCOr","./types":"UL96","./Context":"z1yr"}],"lfyK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("discord.js"),t=require("../Context"),n=require("../helpers");exports.HelpCommand={name:"help",desc:"Show this help message",usage:"help",aliases:["h"],useDefaultPrefix:!0,adminOnly:!1,execute:function(s){const l=n.isAdministrator(s.member),i=(new e.RichEmbed).setTitle("Help");for(let e=0;e<t.Context.commands.length;e++){const n=t.Context.commands[e];if(!l&&n.adminOnly)continue;let s="";n.adminOnly&&(s+="**ADMIN ONLY**\n"),s+="`",n.useDefaultPrefix&&(s+=`${t.Context.prefix} `),s+=`${n.usage}\``;let a=`${n.desc}`;if(null!=n.example){let e="`";n.useDefaultPrefix&&(e+=`${t.Context.prefix} `),a+=`\n**Example :** \`${e+=`${n.example}\``}\``}e!=t.Context.commands.length-1&&(a+=`\n${"=".repeat(50)}`),i.addField(s,a)}s.channel.send({embed:i})}};
},{"../Context":"z1yr","../helpers":"uCOr"}],"w+iM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("node-cache");class t{constructor(t){this.cache=new e({stdTTL:t,checkperiod:.2*t,useClones:!1})}get(e,t){const s=this.cache.get(e);return s?Promise.resolve(s):t().then(t=>(this.cache.set(e,t),t))}del(e){this.cache.del(e)}delStartWith(e=""){if(!e)return;const t=this.cache.keys();for(const s of t)0===s.indexOf(e)&&this.del(s)}flush(){this.cache.flushAll()}}exports.default=t;
},{}],"HFnL":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const e=t(require("axios")),a=t(require("../Cache")),r=require("../types");class h{constructor(){this.cache=new a.default(3600)}async getChapterLink(t,e){return`https://mangadex.org/chapter/${(await this.getChapterWithRetry(t,e)).id}`}async getChapterWithRetry(t,e){let a=!0;for(;;)try{return await this.getChapter(t,e)}catch(r){if(!a)throw r;this.cache.del(e),a=!1}}async getChapter(t,e){const a=(await this.cache.get(e,h.getChapterList.bind(null,e))).find(e=>e.chapter==t);if(null==a)throw new r.CommandError(`Cannot find chapter Nº${t}`);return a}static async getChapterList(t){const a=[],r=(await e.default.get(`https://mangadex.org/api/manga/${t}`).catch(()=>[])).data.chapter;for(const e in r){const t=r[e];"gb"==t.lang_code&&a.push({id:e,title:t.title,chapter:t.chapter,volume:t.volume})}return a}async getChapterPageLink(t,e,a){const i=await this.getChapterWithRetry(t,a),n=await this.cache.get(`${i.id}-pages`,h.getChapterPages.bind(null,i)),s=n.page_array[e-1];if(null==s)throw new r.CommandError(`Cannot find page Nº${e} in chapter Nº${t}`);return n.server.startsWith("/")&&(n.server=`https://mangadex.org${n.server}`),{site:`https://mangadex.org/chapter/${i.id}/${e}`,image:`${n.server}${n.hash}/${s}`}}static async getChapterPages(t){const a=await e.default.get(`https://mangadex.org/api/chapter/${t.id}`).catch(()=>{throw new r.CommandError(`Cannot find pages for chapter Nº${t.chapter}`)});return{id:a.data.id.toString(),hash:a.data.hash,server:a.data.server,page_array:a.data.page_array}}}exports.default=h;
},{"../Cache":"w+iM","../types":"UL96"}],"NZzW":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const a=e(require("../ExternalApi/MangadexLinkGetter")),t=require("../types"),n=new a.default,r=async function(e,a,r){const s=Number(a[0]);if(isNaN(s))throw new t.CommandError(`Missing [chapter]\n\`${this.usage}\``);if(a.length>=2){const i=Number(a[1]);if(isNaN(i))throw new t.CommandError(`Invalid [page] (must be a number)\n\`${this.usage}\``);const o=await n.getChapterPageLink(s,i,r);if("string"==typeof o)throw new t.CommandError(o);e.channel.send(`<${o.site}>`,{file:o.image})}else e.channel.send(await n.getChapterLink(s,r))};exports.ChapterBSCommand={name:"bs!",desc:"Send link to Beastars chapter Nº[chapter] or post page Nº(page) from chapter [chapter]",usage:"bs! [chapter] (page)",example:"bs! 10",useDefaultPrefix:!1,adminOnly:!1,execute:async function(e,a){await r.call(this,e,a,t.Manga.Beastars)}},exports.ChapterBCCommand={name:"bc!",desc:"Send link to Beast Complex chapter Nº[chapter] or post page Nº(page) from chapter [chapter]",usage:"bc! [chapter] (page)",example:"bc! 2",useDefaultPrefix:!1,adminOnly:!1,execute:async function(e,a){await r.call(this,e,a,t.Manga.BeastComplex)}};
},{"../ExternalApi/MangadexLinkGetter":"HFnL","../types":"UL96"}],"Tu7G":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const e=t(require("axios")),r=require("../types");class a{static async searchFirstLink(t){return(await this.searchArticles(t))[0].url}static async searchArticles(t){const a=`https://beastars-eng.fandom.com/api/v1/Search/List?query=${encodeURIComponent(t)}`;return(await e.default.get(a).catch(()=>{throw new r.CommandError(`Cannot find article with search query \`${t}\``)})).data.items}}exports.Wikia=a;
},{"../types":"UL96"}],"htDZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../types"),i=require("../ExternalApi/Wikia");exports.WikiCommand={name:"wiki",desc:"Search on the beastars wiki",usage:"wiki [query]",example:"wiki Haru",aliases:["w"],useDefaultPrefix:!0,adminOnly:!1,execute:async function(a,s){if(0==s.length)throw new e.CommandError(`Missing [query]\n\`${this.usage}\``);const n=s.join(" ");a.channel.send(await i.Wikia.searchFirstLink(n))}};
},{"../types":"UL96","../ExternalApi/Wikia":"Tu7G"}],"IFhs":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const e=require("url"),s=t(require("axios")),r=require("../types"),a=t(require("../Cache")),o=new a.default(86400);class n{static async getRandomQuote(){const t=await o.get("quotes",this.getAllQuotes);if(0===t.length)throw o.flush(),new r.CommandError("Unable to find a quote");return t[Math.floor(Math.random()*t.length)]}static async getAllQuotes(){const t=new e.URL(`https://api.tumblr.com/v2/blog/${n.identifer}/posts`);t.searchParams.append("api_key",process.env.TUMBLR_API_KEY),t.searchParams.append("limit","20"),t.searchParams.append("filter","text");const a=async(e=0)=>{const o=[];t.searchParams.set("offset",e.toString());const n=(await s.default.get(t.toString()).catch(()=>{throw new r.CommandError("Cannot access tumblr's api")})).data.response;if(n.posts.length>0){for(const t of n.posts)"text"!==t.type&&"chat"!==t.type||!t.tags.includes("incorrect beastars quotes")||o.push({url:t.post_url,text:t.body});if(20===n.posts.length)return o.concat(await a(e+20))}return o};return await a()}}n.identifer="incorrect-beastars",exports.IncorrectBeastarsQuote=n;
},{"../types":"UL96","../Cache":"w+iM"}],"Lp4y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../ExternalApi/IncorrectBeastarsQuote");exports.QuoteComment={name:"quote",desc:"Send a random incorrect beastars quote (from incorrect-beastars.tumblr.com)",usage:"quote",aliases:["q"],useDefaultPrefix:!0,adminOnly:!1,execute:async function(t){const r=await e.IncorrectBeastarsQuote.getRandomQuote();t.channel.send(`<${r.url}>`,{embed:{description:r.text}})}};
},{"../ExternalApi/IncorrectBeastarsQuote":"IFhs"}],"dv+A":[function(require,module,exports) {
"use strict";var e,t=this&&this.__decorate||function(e,t,n,i){var r,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});const i=require("typeorm"),r=require("../../Context");let s=e=class extends i.BaseEntity{legsGiven(){return this.legsGivenTo.length}legsRecieved(){return this.legsRecieved.length}getDiscordMember(e){return e.members.get(this.discordId)}getDiscordUser(e){return this.getDiscordMember(e).user}async getNickname(e=null,t=""){if(null!==e){const n=this.getDiscordMember(e);if(null!=n)return t+n.displayName+t}return t+(await r.Context.client.fetchUser(this.discordId)).username+t}async getStats(e){const t=await(async()=>{if(0===this.legsGivenTo.length)return"has not given any legs";const t=[];for(const n of this.legsGivenTo)t.push(await n.getNickname(e,"**"));return`has given ${t.length} leg${1===t.length?"":"s"} to (${t.join(", ")})`})(),n=await(async()=>{if(0===this.legsReceivedFrom.length)return"has not received any legs";const t=[];for(const n of this.legsReceivedFrom)t.push(await n.getNickname(e,"**"));return`has received ${t.length} leg${1===t.length?"":"s"} from (${t.join(", ")})`})();return`${await this.getNickname(e,"**")} ${t} and ${n}`}async giveLegTo(e){this.legsGivenTo.push(e),await this.save(),await e.reload()}hasGivenLegTo(e){return null!=this.legsGivenTo.find(t=>t.discordId===e.discordId)}static async findOrCreate(t){let n=await e.findOne({where:{discordId:t},relations:["legsGivenTo","legsReceivedFrom"]});return null==n&&(n=await e.create({discordId:t}).save(),n=await e.findOne(n.id,{relations:["legsGivenTo","legsReceivedFrom"]})),n}};t([i.PrimaryGeneratedColumn(),n("design:type",Number)],s.prototype,"id",void 0),t([i.Column({unique:!0}),n("design:type",String)],s.prototype,"discordId",void 0),t([i.ManyToMany(t=>e,e=>e.legsReceivedFrom,{cascade:!0}),i.JoinTable({name:"users_legs",joinColumn:{name:"from",referencedColumnName:"id"},inverseJoinColumn:{name:"to",referencedColumnName:"id"}}),n("design:type",Array)],s.prototype,"legsGivenTo",void 0),t([i.ManyToMany(t=>e,e=>e.legsGivenTo),n("design:type",Array)],s.prototype,"legsReceivedFrom",void 0),s=e=t([i.Entity()],s),exports.User=s;
},{"../../Context":"z1yr"}],"KN//":[function(require,module,exports) {
"use strict";var e=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(exports,"__esModule",{value:!0});const r=require("../types"),t=require("../helpers"),a=require("../db/entities/User"),n=require("../Context"),o=e(require("moment")),s=(e,a)=>{const n=t.findMemberByUsername(e,a);if(0==n.length)throw new r.CommandError(`Unable to find user ${a}`);if(n.length>1){let e=n.map(e=>`**${e.displayName}** (${e.user.username}#${e.user.discriminator})`);throw new r.CommandError(`Ambiguous user between : \n${e.join("\n")}`)}return n[0]};exports.OfferLegCommand={name:"offer",desc:"Offer on of your leg to a member\nSupports partial usernames (toma for tomato50)",usage:"offer [username]",example:"offer yyao",aliases:["o"],useDefaultPrefix:!0,adminOnly:!1,execute:async function(e,t,i){if(0==t.length)throw new r.CommandError(`Missing [username]\n\`${n.Context.prefix} ${this.usage}\``);await(async(e,t)=>{const n=e.member,i=o(n.joinedAt).add(24,"hours"),m=o();if(m<i){const e=o.duration(i.diff(m));throw new r.CommandError(`You need to wait 24h after joining this server before you can offer your leg to someone (${e.hours()} hours and ${e.minutes()} minutes remaining).`)}const u=(()=>1===e.mentions.members.size?e.mentions.members.first():s(e.guild,t))(),d=await a.User.findOrCreate(u.user.id),f=await a.User.findOrCreate(e.author.id);if(d.id==f.id)throw new r.CommandError("You can't offer your leg to yourself");if(2===await f.legsGiven())throw new r.CommandError("You have no legs left");if(f.hasGivenLegTo(d))throw new r.CommandError(`You have already given a leg to ${u.displayName}`);const l=await e.channel.send("_ _");await l.edit(`Are you sure you want to give your leg to <@${d.discordId}>, this action is **permanent** !\nReply with "yes" to confirm it.\nWill expire in 20 seconds...`);const h=await e.channel.awaitMessages(r=>r.author.id==e.author.id,{max:1,time:2e4});l.deletable&&l.delete(),h.size>0&&"yes"==h.first().content.toLowerCase()&&(await f.giveLegTo(d),await e.channel.send(`**${n.displayName}** has offered one of their legs to **${u.displayName}**`))})(e,i)}},exports.LegStatsCommand={name:"stats",desc:"Get the leg stats of self (no argument) or of member (username)\nSupports partial usernames (toma for tomato50)",usage:"stats (username)",example:"stats yyao",aliases:["s","stat"],useDefaultPrefix:!0,adminOnly:!1,execute:async function(e,r,t){let n;n=0===r.length?e.member.user.id:1===e.mentions.members.size?e.mentions.members.first().user.id:s(e.guild,t).user.id;const o=await a.User.findOrCreate(n);await e.channel.send(await o.getStats(e.guild))}};
},{"../types":"UL96","../helpers":"uCOr","../db/entities/User":"dv+A","../Context":"z1yr"}],"FAa3":[function(require,module,exports) {
"use strict";var e,t,r,a=this&&this.__decorate||function(e,t,r,a){var i,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,a);else for(var d=e.length-1;d>=0;d--)(i=e[d])&&(o=(n<3?i(o):n>3?i(t,r,o):i(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(exports,"__esModule",{value:!0});const n=require("typeorm"),o=require("./User"),d=require("string-similarity");let s=e=class extends n.BaseEntity{info(e){const t=this.addedBy.getDiscordMember(e);return`${this.name} (<${this.url}>) added ${this.createdAt.toISOString()} by **${t.displayName}** (${t.user.username}#${t.user.discriminator})`}static findImage(t){return e.createQueryBuilder("image").leftJoinAndSelect("image.addedBy","addedBy").where("LOWER(image.name) = LOWER(:name)",{name:t}).getOne()}static async nameExist(t){return await e.createQueryBuilder("image").where("LOWER(image.name) = LOWER(:name)",{name:t}).getCount()>0}static async mostSimilarName(t){const r=(await e.find({select:["name"]})).map(e=>e.name);return d.findBestMatch(t,r).bestMatch.target}};a([n.PrimaryGeneratedColumn(),i("design:type",Number)],s.prototype,"id",void 0),a([n.Column({unique:!0}),i("design:type",String)],s.prototype,"name",void 0),a([n.Column(),i("design:type",String)],s.prototype,"url",void 0),a([n.ManyToOne(e=>o.User,{eager:!0}),i("design:type","function"==typeof(t=void 0!==o.User&&o.User)?t:Object)],s.prototype,"addedBy",void 0),a([n.CreateDateColumn(),i("design:type","function"==typeof(r="undefined"!=typeof Date&&Date)?r:Object)],s.prototype,"createdAt",void 0),s=e=a([n.Entity()],s),exports.Image=s;
},{"./User":"dv+A"}],"V3fb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../types"),a=require("../db/entities/Image"),n=require("../db/entities/User"),i=require("../helpers");exports.ImageAddCommand={name:"image add",desc:"Add an image to to the image list",usage:"image add [name] [url]",example:"image add cool-pic http://site.com/image.png",aliases:["i add"],useDefaultPrefix:!0,adminOnly:!0,execute:async function(i,m){if(0==m.length)throw new e.CommandError(`Missing [name]\n\`${this.usage}\``);if(1==m.length)throw new e.CommandError(`Missing [url]\n\`${this.usage}\``);const t=m[0],s=m[1];if(["add","remove","list"].includes(t.toLowerCase()))throw new e.CommandError("Forbidden image names : `add`, `remove` or `list`");const o=await a.Image.findImage(t);if(null!=o)throw new e.CommandError(`Image \`${t}\` already exists :\n${o.info(i.guild)}`);const r=new a.Image;r.name=t,r.url=s,r.addedBy=await n.User.findOne({where:{discordId:i.member.user.id}}),await r.save(),await i.channel.send(`Image \`${t}\` (<${s}>) added to list`)}},exports.ImageRemoveCommand={name:"image remove",desc:"Remove an image to to the image list",usage:"image remove [name]",example:"image remove cool-pic",aliases:["i remove"],useDefaultPrefix:!0,adminOnly:!0,execute:async function(n,i){if(0==i.length)throw new e.CommandError(`Missing [name]\n\`${this.usage}\``);const m=i[0],t=await a.Image.findImage(m);if(null==t)throw new e.CommandError(`Image \`${m}\` does not exist`);await t.remove(),await n.channel.send(`Image \`${m}\` removed`)}},exports.ImageListCommand={name:"image list",desc:"Show the list of images",usage:"image list",aliases:["i list"],useDefaultPrefix:!0,adminOnly:!1,execute:async function(n){const m=e=>{let a="";for(const n of e)a+=`${n.name} <${n.url}>\n`;return a},t=await a.Image.find();if(0===t.length)throw new e.CommandError(`There is currently no images in the database.\nAn admin can add images with \`${exports.ImageAddCommand.usage}\``);const s=i.chunkArray(t,10);for(const e of s)await n.channel.send(m(e))}},exports.ImageCommand={name:"image post",desc:"Post an image named [name]",usage:"image post [name]",aliases:["i post","image","i"],useDefaultPrefix:!0,adminOnly:!1,execute:async function(n,i){if(0==i.length)throw new e.CommandError(`Missing [name]\n\`${this.usage}\``);const m=i[0],t=await a.Image.findImage(m);if(null==t)throw new e.CommandError(`Image \`${m}\` does not exist\n Did you mean \`${await a.Image.mostSimilarName(m)}\`?`);await n.channel.send({file:t.url})}};
},{"../types":"UL96","../db/entities/Image":"FAa3","../db/entities/User":"dv+A","../helpers":"uCOr"}],"FzAC":[function(require,module,exports) {
"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const e=t(require("axios")),a=require("../types"),r=t(require("../Cache")),n=new r.default(86400);class s{static async getRandomImageInAlbum(t){const e=await n.get(t,this.getAllImagesInAlbum.bind(this,t));if(0===e.length)throw n.flush(),new a.CommandError("Unable to find an image");return e[Math.floor(Math.random()*e.length)]}static async getAllImagesInAlbum(t){const r=`https://api.imgur.com/3/album/${t}/images`,n=await e.default.get(r,{headers:{Authorization:`Client-ID ${process.env.IMGUR_CLIENT_ID}`}}).catch(()=>{throw new a.CommandError("Cannot access imgur's api")}),s=[];for(const e of n.data.data)s.push(e.link);return s}}exports.Imgur=s;
},{"../types":"UL96","../Cache":"w+iM"}],"0kpq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("../ExternalApi/Imgur");exports.OocCommand={name:"ooc",desc:"Send a random out of context image from the manga",usage:"ooc",useDefaultPrefix:!0,adminOnly:!1,execute:async function(n){const o=await e.Imgur.getRandomImageInAlbum("tCDHjVx");n.channel.send({file:o})}};
},{"../ExternalApi/Imgur":"FzAC"}],"gHT6":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const m=e(require("./Parser")),n=require("./types"),o=require("./Context"),a=require("./Commands/HelpCommand"),r=require("./Commands/ChapterCommands"),t=require("./Commands/WikiCommand"),s=require("./Commands/QuoteCommand"),d=require("./Commands/LegCommand"),i=require("./helpers"),C=require("./Commands/ImageCommands"),c=require("./Commands/OOCCommand"),u=process.env.PREFIX,l=[a.HelpCommand,r.ChapterBSCommand,r.ChapterBCCommand,t.WikiCommand,s.QuoteComment,c.OocCommand,d.OfferLegCommand,d.LegStatsCommand,C.ImageAddCommand,C.ImageRemoveCommand,C.ImageListCommand,C.ImageCommand],g=new m.default(u,l);function f(e){const m=m=>{m instanceof n.CommandError?e.channel.send(`:x: ${m.message}`):console.log(m)};try{const a=g.parseCommand(e.content);if(!a.success){const m=e.guild.emojis.find(e=>"Sebun_Cheeks"==e.name),n=e.guild.emojis.find(e=>"Legoshi_Lick"==e.name);if(null==m||null==n)return;return void(new RegExp(`(${i.escapeRegExp(m.toString())}\\s*){3}`).test(e.content)&&e.react(n))}if(a.command.adminOnly&&!i.isAdministrator(e.member))throw new n.CommandError("Only administrators can use this command");const r=a.command.execute.call(a.command,e,a.args,a.fullArgs);r instanceof Promise&&r.catch(m)}catch(o){m(o)}}o.Context.prefix=u,o.Context.commands=l,exports.executeCommand=f;
},{"./Parser":"E3oo","./types":"UL96","./Context":"z1yr","./Commands/HelpCommand":"lfyK","./Commands/ChapterCommands":"NZzW","./Commands/WikiCommand":"htDZ","./Commands/QuoteCommand":"Lp4y","./Commands/LegCommand":"KN//","./helpers":"uCOr","./Commands/ImageCommands":"V3fb","./Commands/OOCCommand":"0kpq"}],"7QCb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("dotenv").config(),require("reflect-metadata");const e=require("typeorm"),t=require("./Context"),r=require("./Execute"),n=require("discord.js");e.createConnection().then(()=>{const e=new n.Client;if(t.Context.client=e,e.on("ready",async()=>{await e.user.setPresence({status:"online",game:{name:`Use ${t.Context.prefix} help`}}),console.log("Bot is ready")}),e.on("message",async e=>{r.executeCommand(e)}),e.login(process.env.TOKEN),"true"==process.env.HEROKU_KEEP_AWAKE.toLowerCase()){var o=require("http");setInterval(function(){o.get(process.env.HEROKU_URL)},3e5)}});
},{"./Context":"z1yr","./Execute":"gHT6"}]},{},["7QCb"], null)